sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/Fragment","sap/ui/model/Sorter","sap/ui/Device","sap/ui/core/routing/History","sap/m/ColumnListItem","sap/m/Input","sap/base/util/deepExtend","sap/ui/export/Spreadsheet","sap/m/MessageToast","sap/m/MessageBox","sap/m/ObjectIdentifier","sap/m/Text","sap/m/Button","sap/m/Dialog","../utils/formatter"],function(e,t,a,i,s,r,n,o,l,u,d,g,h,c,m,M,p,f,w){"use strict";return e.extend("com.agel.mmts.returnmaterial.controller.ReturnMaterialDetailPage",{formatter:w,onInit:function(){this.getView().addEventDelegate({onAfterShow:this.onBeforeShow},this);var e=new t({busy:false,delay:0,boqSelection:null,csvFile:"file"});this.getView().setModel(e,"objectViewModel");this._mViewSettingsDialogs={};this.MainModel=this.getOwnerComponent().getModel();this.getView().setModel(this.MainModel);this.oRouter=this.getRouter();this.oRouter.getRoute("RouteReturnDetailPage").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(e){var t=this;var a=e.getParameter("arguments").Id;t.sObjectId=a;this._bindView("/ReturnMaterialSet("+a+")")},_bindView:function(e){var t=this;var a=this.getView().getModel("objectViewModel");this.getView().bindElement({path:e,parameters:{$expand:"ReturnMaterialReserve"},events:{dataRequested:function(){a.setProperty("/busy",true)},dataReceived:function(){a.setProperty("/busy",false)}}})},getViewSettingsDialog:function(e){var t=this._mViewSettingsDialogs[e];if(!t){t=s.load({id:this.getView().getId(),name:e,controller:this}).then(function(e){if(n.system.desktop){e.addStyleClass("sapUiSizeCompact")}return e});this._mViewSettingsDialogs[e]=t}return t},onReadDataIssueMaterialParents:function(){var e=this;e.oIssueMaterialModel=new t;this.MainModel.read("/SONumberDetailsSet("+e.sObjectId+")",{urlParameters:{$expand:"IssuedMaterialParent/IssuedMaterialBOQ"},success:function(t,a){debugger;e.dataBuilding(t.IssuedMaterialParent.results)}.bind(this),error:function(e){sap.m.MessageBox.error("Data Not Found")}})},dataBuilding:function(e){this.ParentDataView=e;for(var t=0;t<e.length;t++){if(e[t].IssuedMaterialBOQ.results.length){this.ParentDataView[t].isStandAlone=true;this.ParentDataView[t].ChildItemsView=e[t].IssuedMaterialBOQ.results}else{this.ParentDataView[t].isStandAlone=false;this.ParentDataView[t].ChildItemsView=[]}}this.arrangeDataView()},onCancelReturn:function(e){debugger;var t=this.getView().getBindingContext().getObject().ID;var a="/ReturnMaterialSet("+parseInt(t)+"l)/ReturnMaterialReserve";var i=this.getView().getModel().getData(a).ID;var s={ID:"1",UserName:"Test",ReturnMaterialId:t,ReturnMaterialReserveId:i};this.MainModel.update("/ReturnMaterialCancellationEdmSet",s,{success:function(e,t){debugger}.bind(this),error:function(e){debugger;sap.m.MessageBox.error("Data Not Found")}})}})});